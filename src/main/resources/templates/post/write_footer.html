<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div th:fragment="write_footer">
    <th:block layout:fragment="script">
        <script th:inline="javascript">
            $(function () {
                $('#summernote').summernote({
                    placeholder: '내용을 입력해주세요.',
                    tabsize: 2,
                    height: 600,
                    lang: 'ko-KR', // default: 'en-US'
                    toolbar: [
                        ['style', ['style']],
                        ['font', ['bold', 'underline', 'clear']],
                        ['color', ['color']],
                        ['para', ['ul', 'ol', 'paragraph']],
                        ['table', ['table']],
                        ['insert', ['link', 'picture']],
                        ['view', ['codeview']]
                    ],
                    codeviewFilter: true,
                    codeviewIframeFilter: true
                });

                // var markupStr = $('#summernote').summernote('code'); // get
                // var markupStr = 'hello world';
                // $('#summernote').summernote('code', markupStr); // set

                $("#btnSave").on("click", function () {
                    let url = $(location).attr('pathname');
                    let data = {
                        "boardId": $("#boardId option:selected").val(),
                        "postTitle": $("#postTitle").val(),
                        "postContent": $('#summernote').summernote('code'),
                        "postWriter": $("#postWriter").val(),
                        // "attaches" : attaches // 여기서부터 이어서...
                    }

                    $.ajax({
                        type: 'post',
                        url: url,
                        async: true,
                        dataType: 'json',
                        data: data,
                        success: function (result) {
                            if (result.msg) {
                                alert(result.msg);
                                location.href = "/board/[(${boardId})]/list";
                            } else {
                                location.href = "/board/[(${boardId})]/view/" + result.postId;
                            }
                        },
                        error: function (request, status, error) {
                            console.log(error);
                        }
                    })
                });
            });
        </script>
    </th:block>
</div>
</html>